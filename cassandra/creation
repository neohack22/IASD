-- 1 1. Pour chaque modèle ci-dessous, 
-- vous devrez :

-- b. Modèle colonne en utilisant Cassandra

-- (i) Implémenter le modèle et donner les commandes de création du modèle, 
-- en expliquant quelle partie du modèle SQL vous avez choisi 
-- d’implémenter (si vous n’avez choisi d’en implémenter qu’une partie),

CREATE KEYSPACE IF NOT EXISTS GestionMusique
WITH REPLICATION = { 
    'class' : 'SimpleStrategy', 'replication_factor': 3};

USE GestionMusique;    

create type GestionMusique.Utilisateurs (
    UID  int, nom text, prenom text, dateNaissance date);

create type GestionMusique.Artiste (AID int, nomArtiste text);

create type GestionMusique.Musique (
    MID  int, titre text, Artiste frozen<Artiste>
);

create type GestionMusique.Playlist (
    PID  int, nom text, Utilisateurs frozen<Utilisateurs>
);

create type GestionMusique.Contenu (
    PID frozen<Playlist>, MID frozen<Musique>
);

CREATE TABLE GestionMusique.Recommandation (
    id UUID PRIMARY KEY, UID frozen<Utilisateurs>, Musique frozen<Musique>
);

CREATE TABLE GestionMusique.Musique (
    id UUID, MID int, titre text, Artiste frozen<Artiste>, 
    Playlist int, PRIMARY KEY(id, playlist, Artiste)
);

CREATE TABLE GestionMusique.Utilisateurs (
    UID int, nom text, prenom text, dateNaissance text, AID int, 
    nomArtiste text, primary key(nomArtiste, UID, dateNaissance
    ));

CREATE TABLE GestionMusique.Contenu (
    PID int, UID int, nom text, prenom text, MID int, titre text, 
    AID int, nomArtiste text, PRIMARY KEY(uid, NomArtiste, PID, titre, MID)
);

create TABLE GestionMusique.Indicatrice (
    IID int, UID int, nom text, prenom text, JUL int, Pomme int, Queen int, 
    PRIMARY KEY(UID, Queen, Pomme, JUL, IID));


-- (ii) indiquer à quelles requêtes (
--    rappelées ci-dessous) votre modèle permet de répondre et donner le 
-- code de vos requêtes,

-- a. Qui (
--    en donnant son nom et son prénom) a une musique d’un artiste nommé 
-- x (ex. 'Pomme') dans sa liste de musiques ?

-- Exemple d'insertion

--INSERT INTO Utilisateur(Nom,Prenom,DateNaissance) VALUES
--('COMPUTING','Claude','12/04/1991');
--INSERT INTO Utilisateur(Nom,Prenom,DateNaissance) VALUES
--('ZARELA','Maude','01/25/1998');
--INSERT INTO Artiste(NomArtiste) VALUES ('Queen');
--INSERT INTO Artiste(NomArtiste) VALUES ('Pomme');
--INSERT INTO Artiste(NomArtiste) VALUES ('Jul');
--INSERT INTO Artiste(NomArtiste) VALUES ('Amy Winehouse');
--INSERT INTO Musique(Titre,AID) VALUES('Ca sent bon',3);
--INSERT INTO Musique(Titre,AID) VALUES('Les oiseaux',2);
--INSERT INTO Musique(Titre,AID) VALUES('Bohemian Rhapsody',1);
--INSERT INTO Musique(Titre,AID) VALUES('Somebody to love',1);
--INSERT INTO Musique(Titre,AID) VALUES('Rehab',4);
--INSERT INTO Playlist(NOM,UID) VALUES('MaListe',2);
--INSERT INTO Playlist(NOM,UID) VALUES('MaListe',1);
--INSERT INTO Contenu(PID, MID) VALUES (1,1),(1,2),(1,3),(2,3),(2,4);

INSERT INTO Utilisateurs JSON ' {
    "UID":1, "nom": "Computing", "prenom":"Claude", 
    "dateNaissance":"12/04/1991", "AID":3, "nomArtiste":"Jul"
}';

INSERT INTO utilisateurs JSON ' {
    "UID":1, "nom": "Computing", "prenom":"Claude", 
    "dateNaissance":"12/04/1991", "AID":2, "nomArtiste":"Pomme"
}';

INSERT INTO utilisateurs JSON ' {
    "UID":1, "nom": "Computing", "prenom":"Claude", 
    "dateNaissance":"12/04/1991", "AID":1, "nomArtiste":"Queen"
}';

INSERT INTO Utilisateurs JSON ' {
    "UID":2, "nom": "ZARELA", "prenom":"Maude", 
    "dateNaissance":"01/25/1998", "AID":1, "nomArtiste":"Queen"
}';

INSERT INTO Contenu JSON ' {
    "PID":1, "UID":2, "Nom":"ZARELA", "Prenom":"Maude", "MID":1, 
    "Titre":"Ca sent bon", "AID":3, "NomArtiste":"Jul"}}
                }
            ';

INSERT INTO Contenu JSON ' {
    "PID":1, "UID":2, "Nom":"ZARELA", "Prenom":"Maude", "MID":2, 
    "Titre":"Les oiseaux", "AID":2, "NomArtiste":"Pomme"
                }
            ';

INSERT INTO Contenu JSON ' {
    "PID":1, "UID":2, "Nom":"ZARELA", "Prenom":"Maude", "MID":3, 
    "Titre":"Bohemian Rhapsody", "AID":1, "NomArtiste":"Queen"
                }
            ';

INSERT INTO Contenu JSON ' {
    "PID":2, "UID":1, "Nom":"COMPUTING", "Prenom":"Claude", "MID":3, 
    "Titre":"Bohemian Rhapsody", "AID":1, "NomArtiste":"Queen"
                }
            ';


INSERT INTO Contenu JSON ' {
    "PID":2, "UID":1, "Nom":"COMPUTING", "Prenom":"Claude", "MID":4, 
    "Titre":"Somebody to love", "AID":1, "NomArtiste":"Queen"
                }
            ';

            
INSERT INTO Musique JSON ' {
    "id":"50554d6e-29bb-11e5-b345-feff819cdc9e", 
    "MID":1, "titre":"Ca sent bon", "Artiste":{
        "AID":3, "NomArtiste":"Jul"}, "Playlist":3}';
        
            
INSERT INTO Musique JSON ' {
    "id":"50554d6e-29bb-11e5-b345-feff819cdc9f", 
    "MID":2, "titre":"Les oiseaux", "Artiste":{
        "AID":2, "NomArtiste":"Pomme"}, "Playlist":1}';

            
INSERT INTO Musique JSON ' {
    "id":"01234567-0123-0123-0123-0123456789ab", 
    "MID":3, "titre":"Bohemian Rhapsody", "Artiste":{
        "AID":1, "NomArtiste":"Queen"}, "Playlist":2
        }';

            
INSERT INTO Musique JSON ' {
    "id":"01234567-0123-0123-0123-0123456789ac", 
    "MID":4, "titre":"Somebody to love", "Artiste":{
        "AID":1, "NomArtiste":"Queen"}, "Playlist":1
            }
            
        }}';

            
INSERT INTO Musique JSON ' {
    "id":"01234567-0123-0123-0123-0123456789ad", 
    "MID":5, "titre":"Rehab", "Artiste":{
        "AID":4, "NomArtiste":"Amy Winehouse"}, "playlist":0}';

INSERT INTO Indicatrice JSON ' {
    "IID":1, "UID":1, "nom":"COMPUTING", "prenom":"Claude", "JUL":1, "Pomme":0, "Queen":0
}        ';

INSERT INTO Indicatrice JSON ' {
    "IID":2, "UID":1, "nom":"COMPUTING", "prenom":"Claude", "JUL":0, "Pomme":1, "Queen":0
}        ';

INSERT INTO Indicatrice JSON ' {
    "IID":3, "UID":1, "nom":"COMPUTING", "prenom":"Claude", "JUL":0, "Pomme":0, "Queen":1
}        ';

INSERT INTO Indicatrice JSON ' {
    "IID":4, "UID":2, "nom":"ZARELA", "prenom":"Maude", "JUL":0, "Pomme":0, "Queen":1
}        ';

INSERT INTO Indicatrice JSON ' {
    "IID":5, "UID":2, "nom":"ZARELA", "prenom":"Maude", "JUL":0, "Pomme":0, "Queen":1
}        ';