-- 1 1. Pour chaque modèle ci-dessous, 
-- vous devrez :

-- b. Modèle colonne en utilisant Cassandra

-- (i) Implémenter le modèle et donner les commandes de création du modèle, 
-- en expliquant quelle partie du modèle SQL vous avez choisi 
-- d’implémenter (si vous n’avez choisi d’en implémenter qu’une partie),

CREATE KEYSPACE IF NOT EXISTS GestionMusique
WITH REPLICATION = { 
    'class' : 'SimpleStrategy', 'replication_factor': 3};

USE GestionMusique;    

--create type GestionMusique.Utilisateurs (
  --  UID  int, 
    --nom text, 
    --prenom text, 
    --dateNaissance date
--)


--create type GestionMusique.Artiste (
    --AID int, 
    --nomArtiste text
--);

--create type GestionMusique.Musique (
  --  MID  int, 
    --titre text, 
    --Artiste frozen<Artiste>
--);

--create type GestionMusique.Playlist (
  --  PID  int, 
    --nom text, 
    --Utilisateurs frozen<Utilisateurs>
--);

--create type GestionMusique.Contenu (
  --  PID frozen<Playlist>, 
    --MID frozen<Musique>
--);

-- CREATE TABLE GestionMusique.Recommandation (
--     id UUID PRIMARY KEY, 
--     UID frozen<Utilisateurs>, 
--     Musique frozen<Musique>
-- );

--CREATE TABLE GestionMusique.Musique (
--    id UUID, 
--    MID int, 
--    titre text, 
--    Artiste frozen<Artiste>, 
--    Playlist int, 
--    PRIMARY KEY(mid, playlist, id, Artiste)
--);

CREATE TABLE GestionMusique.Utilisateurs (
    UID int, 
    nom text, 
    prenom text, 
    dateNaissance date, 
    sort text, 
--    nomArtiste text, 
    primary key(sort, dateNaissance)
);
--WITH CLUSTERING ORDER BY (dateNaissance);

CREATE TABLE GestionMusique.Contenu (
    Musique_ID int, 
    titre text, 
    nomArtiste text, 
    Playlist_ID int, 
    frequence int,
    Utilisateur_ID int, 
    nom text, 
    prenom text, 
    PRIMARY KEY(Utilisateur_ID, NomArtiste, Musique_ID)
);

CREATE TABLE GestionMusique.Musique (
    Musique_ID int, 
    titre text, 
    nomArtiste text, 
    Playlist_ID int, 
    frequence int,
    Utilisateur_ID int, 
    nom text, 
    prenom text, 
    PRIMARY KEY(NomArtiste, Musique_ID)
);

CREATE TABLE GestionMusique.Artiste (
    AID int, 
    JUL int, 
    Pomme int, 
    Queen int, 
    Utilisateur_ID int, 
    nom text, 
    prenom text, 
    PRIMARY KEY(Utilisateur_ID, Queen, Pomme, JUL, AID)
);

-- create TABLE GestionMusique.Playlist (
--     PID int, MID int, titre text, MaListe_1 int, MaListe_2 int, 
--     PRIMARY KEY(MID, MaListe_1, MaListe_2, PID));

--CREATE TABLE Contenu (
  --PID int, 
  --MID int, 
  --titre text, 
  --playlist_order int,
  --PRIMARY KEY  (playlist_order, PID)
--);

-- (ii) indiquer à quelles requêtes (
--    rappelées ci-dessous) votre modèle permet de répondre et donner le 
-- code de vos requêtes,

-- a. Qui (
--    en donnant son nom et son prénom) a une musique d’un artiste nommé 
-- x (ex. 'Pomme') dans sa liste de musiques ?

-- Exemple d'insertion

--1 INSERT INTO Utilisateur(Nom,Prenom,DateNaissance) VALUES
--('COMPUTING','Claude','12/04/1991');
--2 INSERT INTO Utilisateur(Nom,Prenom,DateNaissance) VALUES
--('ZARELA','Maude','01/25/1998');

--1 INSERT INTO Artiste(NomArtiste) VALUES ('Queen');
--2 INSERT INTO Artiste(NomArtiste) VALUES ('Pomme');
--3 INSERT INTO Artiste(NomArtiste) VALUES ('Jul');
--4 INSERT INTO Artiste(NomArtiste) VALUES ('Amy Winehouse');

--1 INSERT INTO Musique(Titre,AID) VALUES('Ca sent bon',3);
--2 INSERT INTO Musique(Titre,AID) VALUES('Les oiseaux',2);
--3 INSERT INTO Musique(Titre,AID) VALUES('Bohemian Rhapsody',1);
--4 INSERT INTO Musique(Titre,AID) VALUES('Somebody to love',1);
--5 INSERT INTO Musique(Titre,AID) VALUES('Rehab',4);

--1 INSERT INTO Playlist(NOM,UID) VALUES('MaListe',2);
--2 INSERT INTO Playlist(NOM,UID) VALUES('MaListe',1);

--INSERT INTO Contenu(PID, MID) VALUES (1,1),(1,2),(1,3),(2,3),(2,4);

INSERT INTO Utilisateurs JSON ' {
    "UID":1, 
    "nom": "Computing", 
    "prenom": "Claude", 
    "dateNaissance":"1991-12-04"
}';

INSERT INTO Utilisateurs JSON ' {
    "UID":2, 
    "nom": "ZARELA", 
    "prenom": "Maude", 
    "dateNaissance":"1998-01-25"
}';
            
INSERT INTO Contenu JSON ' {
    "Musique_ID":1, 
    "titre": "Ca sent bon", 
    "nomArtiste": "Jul",
    "Playlist_ID":1,
    "frequence": 1,
    "Utilisateur_ID":2, 
    "nom": "ZARELA",
    "prenom": "Maude"
}';

INSERT INTO Contenu JSON ' {
    "Musique_ID":2, 
    "titre": "Les oiseaux", 
    "nomArtiste": "Pomme",
    "Playlist_ID":1,
    "frequence": 1,
    "Utilisateur_ID":2, 
    "nom": "ZARELA",
    "prenom": "Maude"
}';        
            
INSERT INTO Contenu JSON ' {
    "Musique_ID":3, 
    "titre": "Bohemian Rhapsody", 
    "nomArtiste": "Queen",
    "Playlist_ID":1,
    "frequence": 1,
    "Utilisateur_ID":2, 
    "nom": "ZARELA",
    "prenom": "Maude"
}';        

INSERT INTO Contenu JSON ' {
    "Musique_ID":3, 
    "titre": "Bohemian Rhapsody", 
    "nomArtiste": "Queen",
    "Playlist_ID":2,
    "frequence": 2, 
    "Utilisateur_ID":1, 
    "nom": "Computing",
    "prenom": "Claude"
}';

INSERT INTO Contenu JSON ' {
    "Musique_ID":4, 
    "titre": "Somebody to love", 
    "nomArtiste": "Queen", 
    "Playlist_ID":2,
    "frequence": 1, 
    "Utilisateur_ID":1, 
    "nom": "Computing",
    "prenom": "Claude"
}';       

INSERT INTO Contenu JSON ' {
    "Musique_ID":5, 
    "titre": "Rehab", 
    "nomArtiste": "Amy Winehouse", 
    "Playlist_ID":0,
    "frequence": 0, 
    "Utilisateur_ID":0, 
    "nom": "",
    "prenom": ""
}';       



INSERT INTO Musique JSON ' {
    "PID":"50554d6e-29bb-11e5-b345-feff819cdc9f", 
    "MID":2, "titre":"Les oiseaux", "Artiste":{
        "AID":2, "NomArtiste":"Pomme"}, "Playlist":1}';

            
INSERT INTO Musique JSON ' {
    "id":"01234567-0123-0123-0123-0123456789ab", 
    "MID":3, "titre":"Bohemian Rhapsody", "Artiste":{
        "AID":1, "NomArtiste":"Queen"}, "Playlist":2
        }';

            
INSERT INTO Musique JSON ' {
    "id":"01234567-0123-0123-0123-0123456789ac", 
    "MID":4, "titre":"Somebody to love", "Artiste":{
        "AID":1, "NomArtiste":"Queen"}, "Playlist":1
            }
            
        }}';

INSERT INTO Musique JSON ' {
    "id":"01234567-0123-0123-0123-0123456789aa", 
    "MID":3, "titre":"Bohemian Rhapsody", "Artiste":{
        "AID":1, "NomArtiste":"Queen"}, "Playlist":1
        }';
            
INSERT INTO Musique JSON ' {
    "id":"01234567-0123-0123-0123-0123456789ad", 
    "MID":5, "titre":"Rehab", "Artiste":{
        "AID":4, "NomArtiste":"Amy Winehouse"}, "playlist":0}';



INSERT INTO Artiste JSON ' {
    "AID":1, 
    "JUL":1, 
    "Pomme":0, 
    "Queen":0,
    "Utilisateur_ID":1, 
    "nom":"COMPUTING", 
    "prenom":"Claude"
}        ';

INSERT INTO Artiste JSON ' {
    "AID":2, 
    "JUL":0, 
    "Pomme":1, 
    "Queen":0,
    "Utilisateur_ID":1, 
    "nom":"COMPUTING", 
    "prenom":"Claude"
}        ';

INSERT INTO Artiste JSON ' {
    "AID":3, 
    "JUL":0, 
    "Pomme":0, 
    "Queen":1,
    "Utilisateur_ID":1, 
    "nom":"COMPUTING", 
    "prenom":"Claude"
}        ';

INSERT INTO Artiste JSON ' {
    "AID":4, 
    "JUL":0, 
    "Pomme":0, 
    "Queen":1,
    "Utilisateur_ID":2, 
    "nom":"ZARELA", 
    "prenom":"Maude"
}        ';

INSERT INTO Artiste JSON ' {
    "AID":5, 
    "JUL":0, 
    "Pomme":0, 
    "Queen":1,
    "Utilisateur_ID":2, 
    "nom":"ZARELA", 
    "prenom":"Maude"
}        ';

INSERT INTO Playlist JSON ' {
    "PID":1, 
    "MID":1, 
    "titre":"Ca sent bon", 
    "playlist_order":1
}        ';

INSERT INTO Contenu JSON ' {
    "PID":1, 
    "MID":2, 
    "titre":"Les oiseaux", 
    "playlist_order":1
}        ';

INSERT INTO Contenu JSON ' {
    "PID":1, 
    "MID":3, 
    "titre":"Bohemian Rhapsody", 
    "playlist_order":1
}        ';

INSERT INTO Contenu JSON ' {
    "PID":2, 
    "MID":3, 
    "titre":"Bohemian Rhapsody", 
    "playlist_order":2
}        ';

INSERT INTO Contenu JSON ' {
    "PID":2, 
    "MID":4, 
    "titre":"Somebody to love", 
    "playlist_order":1
}        ';


            
INSERT INTO Musique JSON ' {
    "Musique_ID":1, 
    "titre": "Ca sent bon", 
    "nomArtiste": "Jul",
    "Playlist_ID":1,
    "frequence": 1,
    "Utilisateur_ID":2, 
    "nom": "ZARELA",
    "prenom": "Maude"
}';

INSERT INTO Musique JSON ' {
    "Musique_ID":2, 
    "titre": "Les oiseaux", 
    "nomArtiste": "Pomme",
    "Playlist_ID":1,
    "frequence": 1,
    "Utilisateur_ID":2, 
    "nom": "ZARELA",
    "prenom": "Maude"
}';        
            
INSERT INTO Musique JSON ' {
    "Musique_ID":3, 
    "titre": "Bohemian Rhapsody", 
    "nomArtiste": "Queen",
    "Playlist_ID":1,
    "frequence": 1,
    "Utilisateur_ID":2, 
    "nom": "ZARELA",
    "prenom": "Maude"
}';        

INSERT INTO Musique JSON ' {
    "Musique_ID":3, 
    "titre": "Bohemian Rhapsody", 
    "nomArtiste": "Queen",
    "Playlist_ID":2,
    "frequence": 2, 
    "Utilisateur_ID":1, 
    "nom": "Computing",
    "prenom": "Claude"
}';

INSERT INTO Musique JSON ' {
    "Musique_ID":4, 
    "titre": "Somebody to love", 
    "nomArtiste": "Queen", 
    "Playlist_ID":2,
    "frequence": 1, 
    "Utilisateur_ID":1, 
    "nom": "Computing",
    "prenom": "Claude"
}';       

INSERT INTO Musique JSON ' {
    "Musique_ID":5, 
    "titre": "Rehab", 
    "nomArtiste": "Amy Winehouse", 
    "Playlist_ID":0,
    "frequence": 0, 
    "Utilisateur_ID":0, 
    "nom": "",
    "prenom": ""
}';       