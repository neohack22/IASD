-- a. Qui (en donnant son nom et son prénom) a une musique d’un artiste 
-- nommé x (ex. 'Pomme') dans sa liste de musiques ?<br><br>

SELECT playlist.pid.utilisateurs.nom, playlist.pid.utilisateurs.prenom 
FROM Musique
WHERE Artiste.nomartiste= "x" ALLOW FILTERING;

-- b. Qui (en donnant son nom et son prénom) a une musique de d’un 
-- artiste nommé x (ex. ‘Queen’) OU d’un artiste nommé y (ex. ‘Pomme’)
-- dans sa liste de musiques ?<br><br>

SELECT DISTINCT PID.UID.nom, PID.UID.prenom FROM contenu
WHERE PID.MID.Artiste.NomArtiste 
IN ('x', 'y') ALLOW FILTERING;

-- c. Qui (en donnant son nom et son prénom) a une musique d’un artiste 
-- nommé x (ex. ‘Queen’) ET d’un artiste nommé y (ex. ‘Pomme’) dans sa 
-- liste de musiques ?<br><br>

SELECT DISTINCT PID.UID.nom, PID.UID.prenom FROM contenu
WHERE PID.MID.Artiste.NomArtiste = 'x' 
AND PID.MID.Artiste.NomArtiste =  'y' ALLOW FILTERING;

-- d. Quelle musique (en donnant son titre) apparait dans au moins 2 
-- listes de musiques différentes ?<br><br>
SELECT titre FROM musique
GROUP BY titre WHERE COUNT(playlist) > 2 ALLOW FILTERING
-- SELECT titre, count(playlist.pid.pid) FROM musique GROUP BY id ALLOW FILTERING; (fonctionne partiellement)

-- e. Quelle musique (en donnant le titre) n'apparait dans aucune liste 
-- de musiques ?<br><br>
SELECT titre FROM musique
WHERE Playlist = ''

-- f. Quelle musique (en donnant le titre) apparait dans toutes les 
-- listes de musiques de la base de données ?<br><br>
SELECT titre FROM Musique
WHERE (
    COUNT(
        SELECT DISTINCT Playlist FROM Musique
    ) = COUNT(
        SELECT DISTINCT Playlist.PID
    )
)

-- g. Qui (en donnant son nom et son prénom) est le plus jeune 
-- utilisateur de la base ?<br><br>
SELECT Playlist.Utilisateurs.Date FROM Contenu 
ORDER BY Playlist.Utilisateurs.Date LIMIT 1

-- h. Dans combien de listes de musiques apparait chaque musique 
-- (en donnant le titre) ?<br><br> (OK)
SELECT titre, COUNT(Playlist) FROM Musique
GROUP BY id

-- i. Dans combien de listes de musiques apparaît chaque artiste, 
-- en donnant le nom d'artiste, et en indiquant zéro, 
-- quand l'artiste n'apparait dans aucune liste de musiques ?<br><br> (OK)
SELECT Artiste.NomArtiste, COUNT(     Playlist ) FROM Musique GROUP BY id ;